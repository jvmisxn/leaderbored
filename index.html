<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LeaderBored - Friendly Competition Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Apply Inter font globally */
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Simple transition for hover effects */
        a, button, .player-entry {
            transition: all 0.2s ease-in-out;
        }
        /* Hide elements meant for admin by default */
        .admin-only {
            display: none;
        }
        /* Style for showing admin elements when logged in */
        body.admin-logged-in .admin-only {
            display: block; /* Or inline, flex, etc., as appropriate */
        }
        body.admin-logged-in .public-only {
            display: none;
        }
        /* Style for dynamic outcome section */
        .outcome-section, .sub-type-section {
            display: none; /* Hidden by default */
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb; /* gray-200 */
        }
        .outcome-section.active, .sub-type-section.active {
            display: block; /* Shown when active */
        }
        /* Styles for Modals */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0s linear 0.3s;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease;
        }
        .modal-content {
            background-color: white;
            padding: 1.5rem 2rem 2rem 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            max-width: 95%;
            width: 550px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            transform: translateY(-20px) scale(0.98);
            transition: transform 0.3s ease, opacity 0.3s ease;
            opacity: 0;
        }
        .modal-overlay.active .modal-content {
             transform: translateY(0) scale(1);
             opacity: 1;
        }
        .modal-close-button {
             position: absolute;
             top: 0.5rem;
             right: 0.75rem;
             background: none;
             border: none;
             font-size: 1.75rem;
             font-weight: bold;
             color: #6b7280;
             cursor: pointer;
             padding: 0.25rem;
             line-height: 1;
        }
        .modal-close-button:hover {
            color: #1f2937;
        }

        /* Style for Ranking Tables */
        .ranking-table { display: none; }
        .ranking-table.active { display: block; }
        /* Style for multi-select player lists */
        .multi-select-list { max-height: 150px; overflow-y: auto; border: 1px solid #d1d5db; border-radius: 0.375rem; padding: 0.5rem; background-color: #f9fafb; }
        /* Table cell padding */
        td, th { white-space: nowrap; padding-left: 1rem; padding-right: 1rem; padding-top: 0.75rem; padding-bottom: 0.75rem; }
        td { white-space: normal; }
        /* Style for invalid form fields */
        .border-red-500 { border-color: #ef4444; }

        /* Player Modal Edit Mode Styles */
        .modal-editing .editable-field { display: none; } /* Hide static text in edit mode */
        .modal-editing .editing-field { display: block; } /* Show input in edit mode */
        .editing-field { display: none; } /* Hide input by default */
        .modal-editing .edit-mode-controls { display: inline-flex; } /* Show save/cancel/delete */
        .edit-mode-controls { display: none; } /* Hide save/cancel/delete by default */
        .modal-editing .view-mode-controls { display: none; } /* Hide edit button in edit mode */

    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-white to-cyan-50 text-gray-800">
    <nav class="bg-gradient-to-r from-cyan-600 to-blue-700 text-white p-5 shadow-lg sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#home" class="text-3xl font-bold hover:text-blue-100 nav-link" data-target="home-section">üèÜ LeaderBored</a>
            <div class="space-x-5">
                <a href="#home" class="hover:text-blue-100 px-3 py-2 rounded-md text-base font-medium nav-link" data-target="home-section">Home</a>
                <a href="#rankings" class="hover:text-blue-100 px-3 py-2 rounded-md text-base font-medium nav-link" data-target="rankings-section">Rankings</a>
                <a href="#players" class="hover:text-blue-100 px-3 py-2 rounded-md text-base font-medium nav-link" data-target="players-section">Players</a>
                <a href="#tournaments" class="hover:text-blue-100 px-3 py-2 rounded-md text-base font-medium nav-link" data-target="tournaments-section">Tournaments</a>
                <a href="#login" id="login-link" class="bg-yellow-500 hover:bg-yellow-600 text-white px-4 py-2 rounded-lg text-sm font-medium public-only nav-link shadow hover:shadow-md" data-target="login-section">Admin Login</a>
                <a href="#admin" id="admin-link" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg text-sm font-medium admin-only nav-link shadow hover:shadow-md" data-target="admin-section">Admin Panel</a>
                <button id="logout-button" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg text-sm font-medium admin-only shadow hover:shadow-md">Logout</button>
            </div>
        </div>
    </nav>

    <div class="container mx-auto mt-8 p-6">
        <section id="home-section" class="page-section space-y-8"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6">Dashboard</h1> <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Recent Games</h2> <ul id="recent-games-list" class="space-y-4 text-base"> <li class="border-b border-gray-200 pb-3"><strong>Game:</strong> Cornhole (1v1) <br> Charlie beat Alice <span class="text-gray-500 float-right text-sm">Now</span></li> <li class="border-b border-gray-200 pb-3"><strong>Game:</strong> Pool (Cut-Throat FFA) <br> 1st: Bob, 2nd: Dave, 3rd: Eve <span class="text-gray-500 float-right text-sm">15m ago</span></li> <li class="border-b border-gray-200 pb-3"><strong>Game:</strong> Pickleball (2v2) <br> Alice/Bob beat Charlie/Dave <span class="text-gray-500 float-right text-sm">1h ago</span></li> <li><strong>Game:</strong> Golf <br> Alice (+2), Bob (+5), Charlie (-1) <span class="text-gray-500 float-right text-sm">Yesterday</span></li> </ul> <a href="#games" class="text-blue-600 hover:underline mt-5 inline-block font-medium">View all games...</a> </div> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Top Players (Overall)</h2> <ol id="top-players-list" class="list-decimal list-inside space-y-3 text-base"> <li>Alice (1350) <span class="text-green-500 text-sm font-medium ml-1">‚ñ≤ 25</span></li> <li>Charlie (1310) <span class="text-green-500 text-sm font-medium ml-1">‚ñ≤ 15</span></li> <li>Dave (1280) <span class="text-red-500 text-sm font-medium ml-1">‚ñº 10</span></li> <li>Bob (1250) <span class="text-red-500 text-sm font-medium ml-1">‚ñº 25</span></li> <li>Eve (1200) <span class="text-gray-500 text-sm font-medium ml-1">-</span></li> </ol> <a href="#rankings" class="text-blue-600 hover:underline mt-5 inline-block font-medium nav-link" data-target="rankings-section">View full rankings...</a> </div> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Top Teams (Overall)</h2> <ol id="top-teams-list" class="list-decimal list-inside space-y-3 text-base"> <li>Alice & Charlie (1320) <span class="text-green-500 text-sm font-medium ml-1">‚ñ≤ 20</span></li> <li>Team Alpha (1290) <span class="text-green-500 text-sm font-medium ml-1">‚ñ≤ 18</span></li> <li>Bob & Dave (1260) <span class="text-red-500 text-sm font-medium ml-1">‚ñº 20</span></li> <li>Team Beta (1250) <span class="text-red-500 text-sm font-medium ml-1">‚ñº 18</span></li> </ol> <a href="#rankings" class="text-blue-600 hover:underline mt-5 inline-block font-medium nav-link" data-target="rankings-section">View full rankings...</a> </div> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300 md:col-span-2 lg:col-span-1"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Tournaments</h2> <ul id="dashboard-tournaments-list" class="space-y-4"> <li> <span class="font-semibold text-lg">Holiday Pickleball Open</span><span class="text-green-600 font-medium text-sm ml-2">(Ongoing)</span><br> <span class="text-sm text-gray-600">Format: Single Elimination, Game: Pickleball (2v2)</span><br> <a href="#tournament-detail-1" class="text-blue-600 hover:underline text-sm font-medium mt-1 inline-block nav-link" data-target="tournament-detail-section">View Bracket</a> </li> <li class="opacity-75"> <span class="font-semibold text-lg">Cornhole Cup</span><span class="text-yellow-600 font-medium text-sm ml-2">(Upcoming)</span><br> <span class="text-sm text-gray-600">Format: Double Elimination, Game: Cornhole (1v1)</span><br> <span class="text-sm text-gray-500">Starts: Next Weekend</span> </li> </ul> <a href="#tournaments" class="text-blue-600 hover:underline mt-5 inline-block font-medium nav-link" data-target="tournaments-section">View all tournaments...</a> </div> </div> </section>
        <section id="rankings-section" class="page-section hidden space-y-8"> <div class="flex justify-between items-center border-b-2 border-blue-200 pb-3 mb-6"> <h1 class="text-4xl font-bold text-gray-900">Rankings</h1> <div> <label for="rankings-game-filter" class="text-sm font-medium text-gray-700 mr-2">Filter by Game:</label> <select id="rankings-game-filter" name="rankings-game-filter" class="shadow-sm border border-gray-300 rounded-lg py-2 px-3 text-base focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500"> <option value="overall">Overall (1v1/2v2)</option> <option value="pool">Pool</option> <option value="puttpong">PuttPong</option> <option value="golf">Golf</option> <option value="basketball_pickup">Basketball (Pickup)</option> <option value="basketball_horse">Basketball (HORSE)</option> <option value="volleyball_pickup">Volleyball (Pickup)</option> <option value="board_card">Board / Card Game</option> <option value="cornhole">Cornhole</option> <option value="pickleball">Pickleball</option> </select> </div> </div> <div id="ranking-tables-container"> <div id="ranking-table-overall" class="ranking-table active grid grid-cols-1 md:grid-cols-2 gap-8"> <div class="bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Overall 1v1 Rankings (Elo)</h2> <table class="w-full text-left table-auto text-base"> <thead> <tr class="bg-gray-100"> <th class="px-4 py-3">Rank</th> <th class="px-4 py-3">Player</th> <th class="px-4 py-3">Rating</th> <th class="px-4 py-3">Change</th> </tr> </thead> <tbody> <tr class="border-b"> <td class="px-4 py-3">1</td> <td class="px-4 py-3">Alice</td> <td class="px-4 py-3">1350</td> <td class="px-4 py-3 text-green-500">+25</td> </tr> <tr class="border-b"> <td class="px-4 py-3">2</td> <td class="px-4 py-3">Charlie</td> <td class="px-4 py-3">1310</td> <td class="px-4 py-3 text-green-500">+15</td> </tr> <tr class="border-b"> <td class="px-4 py-3">3</td> <td class="px-4 py-3">Dave</td> <td class="px-4 py-3">1280</td> <td class="px-4 py-3 text-red-500">-10</td> </tr> <tr class="border-b"> <td class="px-4 py-3">4</td> <td class="px-4 py-3">Bob</td> <td class="px-4 py-3">1250</td> <td class="px-4 py-3 text-red-500">-25</td> </tr> <tr> <td class="px-4 py-3">5</td> <td class="px-4 py-3">Eve</td> <td class="px-4 py-3">1200</td> <td class="px-4 py-3 text-gray-500">-</td> </tr> </tbody> </table> </div> <div class="bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Overall 2v2 Team Rankings (Elo)</h2> <table class="w-full text-left table-auto text-base"> <thead> <tr class="bg-gray-100"> <th class="px-4 py-3">Rank</th> <th class="px-4 py-3">Team</th> <th class="px-4 py-3">Rating</th> <th class="px-4 py-3">Change</th> </tr> </thead> <tbody> <tr class="border-b"> <td class="px-4 py-3">1</td> <td class="px-4 py-3">Alice & Charlie</td> <td class="px-4 py-3">1320</td> <td class="px-4 py-3 text-green-500">+20</td> </tr> <tr class="border-b"> <td class="px-4 py-3">2</td> <td class="px-4 py-3">Team Alpha</td> <td class="px-4 py-3">1290</td> <td class="px-4 py-3 text-green-500">+18</td> </tr> <tr class="border-b"> <td class="px-4 py-3">3</td> <td class="px-4 py-3">Bob & Dave</td> <td class="px-4 py-3">1260</td> <td class="px-4 py-3 text-red-500">-20</td> </tr> <tr> <td class="px-4 py-3">4</td> <td class="px-4 py-3">Team Beta</td> <td class="px-4 py-3">1250</td> <td class="px-4 py-3 text-red-500">-18</td> </tr> </tbody> </table> </div> </div> <div id="ranking-table-cornhole" class="ranking-table bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Cornhole Rankings (1v1 Elo)</h2> <p class="text-gray-500">Cornhole rankings data would be loaded here...</p> </div> <div id="ranking-table-golf" class="ranking-table bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Golf Rankings (Avg Score to Par)</h2> <p class="text-gray-500">Golf rankings data would be loaded here...</p> </div> <div id="ranking-table-pool" class="ranking-table bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Pool Rankings</h2> <p class="text-gray-500">Pool rankings (1v1, FFA, etc.) would go here...</p> </div> <div id="ranking-table-pickleball" class="ranking-table bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Pickleball Rankings</h2> <p class="text-gray-500">Pickleball rankings (1v1/2v2) would go here...</p> </div> </div> </section>
        <section id="players-section" class="page-section hidden space-y-8"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6">Players</h1> <div id="players-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"> </div> </section> <section id="tournaments-section" class="page-section hidden space-y-8"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6">Tournaments</h1> <div class="bg-white p-8 rounded-xl shadow-lg"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Tournament List</h2> <div id="tournaments-list-full" class="space-y-6"> <div class="border p-5 rounded-lg hover:bg-gray-50 transition duration-200"> <h3 class="font-semibold text-lg">Holiday Pickleball Open</h3> <p class="text-sm text-gray-600 mt-1">Game: Pickleball (2v2) | Format: Single Elimination | Status: <span class="font-medium text-green-600">Ongoing</span></p> <a href="#tournament-detail-1" class="text-blue-600 hover:underline text-sm font-medium mt-2 inline-block nav-link" data-target="tournament-detail-section">View Details & Bracket</a> </div> <div class="border p-5 rounded-lg hover:bg-gray-50 transition duration-200"> <h3 class="font-semibold text-lg">Thanksgiving Codenames Championship</h3> <p class="text-sm text-gray-600 mt-1">Game: Board/Card Game (Team) | Format: Single Elimination | Status: <span class="font-medium text-gray-500">Completed</span></p> <a href="#tournament-detail-2" class="text-blue-600 hover:underline text-sm font-medium mt-2 inline-block nav-link" data-target="tournament-detail-section">View Results</a> </div> <div class="border p-5 rounded-lg hover:bg-gray-50 transition duration-200"> <h3 class="font-semibold text-lg">Cornhole Cup</h3> <p class="text-sm text-gray-600 mt-1">Game: Cornhole (1v1) | Format: Double Elimination | Status: <span class="font-medium text-yellow-600">Upcoming (Starts Next Weekend)</span></p> <a href="#tournament-detail-3" class="text-blue-600 hover:underline text-sm font-medium mt-2 inline-block nav-link" data-target="tournament-detail-section">View Details</a> </div> </div> </div> <div class="admin-only mt-6"> <button class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow hover:shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 nav-link" data-target="admin-create-tournament-section"> Create New Tournament </button> </div> </section>
        <section id="tournament-detail-section" class="page-section hidden space-y-8"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6">Tournament: <span id="tournament-detail-name">[Tournament Name]</span></h1> <div class="bg-white p-8 rounded-xl shadow-lg"> <p class="text-lg mb-1"><strong>Game:</strong> <span id="tournament-detail-game">[Game]</span></p> <p class="text-lg mb-1"><strong>Format:</strong> <span id="tournament-detail-format">[Format]</span></p> <p class="text-lg mb-4"><strong>Status:</strong> <span id="tournament-detail-status">[Status]</span></p> <h2 class="text-2xl font-semibold mt-8 mb-5 text-indigo-700">Bracket / Matches / Standings</h2> <div id="tournament-detail-visualization" class="border-2 border-dashed border-gray-300 p-12 text-center text-gray-500 rounded-lg min-h-[250px]"> Tournament Visualization Area <br>(Requires JavaScript library or custom rendering based on format) </div> <div class="admin-only mt-6"> <button class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-5 rounded-lg shadow hover:shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50"> Report Match Result </button> </div> </div> </section>
        <section id="login-section" class="page-section hidden"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6 text-center">Admin Login</h1> <div class="bg-white p-10 rounded-xl shadow-xl max-w-lg mx-auto"> <form id="login-form"> <div class="mb-6"> <label for="password" class="block text-gray-700 text-sm font-bold mb-2">Password:</label> <input type="password" id="password" name="password" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" required> </div> <div id="login-error" class="text-red-500 text-sm mb-4 hidden">Incorrect password.</div> <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg shadow-md hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75"> Login </button> </form> </div> </section>
        <section id="admin-section" class="page-section hidden admin-only space-y-8"> <h1 class="text-4xl font-bold text-gray-900 border-b-2 border-blue-200 pb-3 mb-6">Admin Panel</h1> <p class="text-green-700 bg-green-100 border border-green-300 p-4 rounded-lg text-center font-medium">You are logged in as Admin.</p> <div class="grid grid-cols-1 md:grid-cols-3 gap-8"> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Add / Record</h2> <div class="space-y-4"> <button class="w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md nav-link" data-target="admin-add-player-section">‚ûï Add New Player</button> <button class="w-full text-left bg-gray-100 hover:bg-gray-200 text-gray-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md nav-link" data-target="admin-add-team-section">‚ûï Add New Team</button> <button id="open-record-game-modal-btn" class="w-full text-left bg-green-100 hover:bg-green-200 text-green-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md">üèÜ Record Game Result</button> </div> </div> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Manage</h2> <div class="space-y-4"> <button class="w-full text-left bg-yellow-100 hover:bg-yellow-200 text-yellow-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md nav-link" data-target="admin-manage-games-section">‚úèÔ∏è Manage Games</button>
        <button class="w-full text-left bg-yellow-100 hover:bg-yellow-200 text-yellow-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md">‚úèÔ∏è Manage Teams</button> </div> </div> <div class="bg-white p-8 rounded-xl shadow-lg hover:shadow-xl transition-shadow duration-300"> <h2 class="text-2xl font-semibold mb-5 text-indigo-700">Tournaments</h2> <div class="space-y-4"> <button class="w-full text-left bg-blue-100 hover:bg-blue-200 text-blue-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md nav-link" data-target="admin-create-tournament-section">‚ûï Create New Tournament</button> <button class="w-full text-left bg-blue-100 hover:bg-blue-200 text-blue-800 font-bold py-3 px-5 rounded-lg shadow-sm hover:shadow-md">‚úèÔ∏è Manage Existing Tournament</button> </div> </div> </div> </section>
        <section id="admin-add-player-section" class="page-section hidden admin-only bg-white p-8 rounded-xl shadow-xl max-w-lg mx-auto"> <h2 class="text-3xl font-semibold mb-6 text-indigo-700">Add New Player</h2> <form id="add-player-form"> <div class="mb-5"> <label for="player-name" class="block text-gray-700 text-sm font-bold mb-2">Player Name:</label> <input type="text" id="player-name" name="player-name" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500" required> </div> <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-5 rounded-lg shadow hover:shadow-md">Add Player</button> <button type="button" class="ml-3 text-gray-600 hover:text-gray-900 font-medium cancel-admin-action" data-target="admin-section">Cancel</button> </form> </section>
        <section id="admin-add-team-section" class="page-section hidden admin-only bg-white p-8 rounded-xl shadow-xl max-w-lg mx-auto"> <h2 class="text-3xl font-semibold mb-6 text-indigo-700">Add New Team (for 2v2)</h2> <form id="add-team-form"> <div class="mb-5"> <label for="team-name" class="block text-gray-700 text-sm font-bold mb-2">Team Name:</label> <input type="text" id="team-name" name="team-name" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700" required> </div> <div class="mb-5"> <label for="team-player1" class="block text-gray-700 text-sm font-bold mb-2">Player 1:</label> <select id="team-player1" name="team-player1" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700" required> <option value="">Select Player</option> <option value="player1_id">Alice (Placeholder)</option> <option value="player2_id">Bob (Placeholder)</option> <option value="player3_id">Charlie (Placeholder)</option> </select> </div> <div class="mb-5"> <label for="team-player2" class="block text-gray-700 text-sm font-bold mb-2">Player 2:</label> <select id="team-player2" name="team-player2" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700" required> <option value="">Select Player</option> <option value="player1_id">Alice (Placeholder)</option> <option value="player2_id">Bob (Placeholder)</option> <option value="player3_id">Charlie (Placeholder)</option> </select> </div> <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-5 rounded-lg shadow hover:shadow-md">Add Team</button> <button type="button" class="ml-3 text-gray-600 hover:text-gray-900 font-medium cancel-admin-action" data-target="admin-section">Cancel</button> </form> </section>
        <section id="admin-create-tournament-section" class="page-section hidden admin-only bg-white p-8 rounded-xl shadow-xl max-w-lg mx-auto"> <h2 class="text-3xl font-semibold mb-6 text-indigo-700">Create New Tournament</h2> <form id="create-tournament-form"> <div class="mb-5"> <label for="tournament-name" class="block text-gray-700 text-sm font-bold mb-2">Tournament Name:</label> <input type="text" id="tournament-name" name="tournament-name" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700" required> </div> <div class="mb-5"> <label for="tournament-game-type-select" class="block text-gray-700 text-sm font-bold mb-2">Game Type:</label> <select id="tournament-game-type-select" name="tournament-game-type" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700" required> <option value="">Select Type</option> <option value="1v1">1 vs 1 (General)</option> <option value="2v2">2 vs 2 (General)</option> <option value="ffa">Free-for-All (FFA - General)</option> <option value="team">Team vs Team (General)</option> <option value="pool">Pool</option> <option value="puttpong">PuttPong</option> <option value="golf">Golf</option> <option value="basketball_pickup">Basketball (Pickup)</option> <option value="basketball_horse">Basketball (HORSE)</option> <option value="volleyball_pickup">Volleyball (Pickup)</option> <option value="board_card">Board / Card Game</option> <option value="cornhole">Cornhole</option> <option value="pickleball">Pickleball</option> </select> </div> <div class="mb-5"> <label for="tournament-format" class="block text-gray-700 text-sm font-bold mb-2">Format:</label> <select id="tournament-format" name="tournament-format" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700" required> <option value="">Select Format</option> <option value="single-elim">Single Elimination</option> <option value="double-elim">Double Elimination</option> <option value="round-robin">Round Robin</option> </select> </div> <div class="mb-5"> <label for="tournament-start-date" class="block text-gray-700 text-sm font-bold mb-2">Start Date (Optional):</label> <input type="date" id="tournament-start-date" name="tournament-start-date" class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700"> </div> <div class="mb-5"> <label class="block text-gray-700 text-sm font-bold mb-2">Participants:</label> <div id="tournament-participants-list" class="h-40 border rounded-lg p-3 overflow-y-auto bg-gray-50 space-y-2"> <p class="text-gray-500 text-sm">Select Game Type to see participants.</p> </div> <p class="text-xs text-gray-500 mt-1">Select participants. Seeding will be based on current rankings for the selected game type.</p> </div> <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-5 rounded-lg shadow hover:shadow-md">Create Tournament</button> <button type="button" class="ml-3 text-gray-600 hover:text-gray-900 font-medium cancel-admin-action" data-target="admin-section">Cancel</button> </form> </section>
        <section id="admin-manage-games-section" class="page-section hidden admin-only space-y-8"> <div class="flex justify-between items-center border-b-2 border-blue-200 pb-3 mb-6"> <h1 class="text-4xl font-bold text-gray-900">Manage Recorded Games</h1> <button class="text-sm text-gray-600 hover:text-gray-900 nav-link font-medium" data-target="admin-section">&larr; Back to Admin Panel</button> </div> <div class="bg-white p-6 rounded-xl shadow-lg overflow-x-auto"> <table class="w-full text-left table-auto text-base"> <thead> <tr class="bg-gray-100"> <th class="px-4 py-3">Date</th> <th class="px-4 py-3">Game Type</th> <th class="px-4 py-3">Description</th> <th class="px-4 py-3">Actions</th> </tr> </thead> <tbody id="manage-games-table-body"> </tbody> </table> </div> </section>

    </div>

    <div id="player-info-modal" class="modal-overlay"> <div class="modal-content">
            <button id="close-player-modal-btn" class="modal-close-button">&times;</button>
            <div class="flex items-center space-x-4 mb-6">
                <img id="modal-player-icon" src="https://placehold.co/80x80/E0E7FF/4F46E5?text=P" alt="Player Icon" class="w-20 h-20 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center text-3xl font-bold">
                <div>
                    <h2 id="modal-player-name" class="text-2xl font-bold text-gray-900 editable-field">[Player Name]</h2>
                    <input type="text" id="modal-edit-player-name-input" name="playerName" class="editing-field shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 text-2xl font-bold leading-tight focus:outline-none focus:ring-2 focus:ring-blue-500" required>
                    <p class="text-sm text-gray-600 mt-1">Overall Rank: <span id="modal-player-overall-rank" class="font-medium">[Rank]</span> (<span id="modal-player-overall-rating">[Rating]</span>)</p>
                </div>
            </div>
            <div class="space-y-4">
                <h3 class="text-lg font-semibold text-indigo-700 border-b pb-1">Game Stats</h3>
                <div id="modal-player-game-stats" class="text-sm space-y-1"></div>
                <h3 class="text-lg font-semibold text-indigo-700 border-b pb-1 mt-4">Recent Activity</h3>
                <ul id="modal-player-recent-activity" class="text-sm space-y-2 list-disc list-inside"></ul>
            </div>
            <div class="mt-6 pt-4 border-t border-gray-200 text-right space-x-3">
                 <button id="edit-player-modal-btn" class="admin-only view-mode-controls text-sm bg-yellow-100 text-yellow-800 hover:bg-yellow-200 font-medium py-2 px-4 rounded-lg shadow-sm">
                     ‚úèÔ∏è Edit Player
                 </button>
                 <div class="edit-mode-controls space-x-3">
                     <button id="save-player-changes-btn" class="text-sm bg-green-600 text-white hover:bg-green-700 font-medium py-2 px-4 rounded-lg shadow-sm">
                         üíæ Save Changes
                     </button>
                     <button id="delete-player-btn" class="text-sm bg-red-600 text-white hover:bg-red-700 font-medium py-2 px-4 rounded-lg shadow-sm">
                         üóëÔ∏è Delete Player
                     </button>
                      <button id="cancel-player-edit-btn" class="text-sm bg-gray-200 text-gray-700 hover:bg-gray-300 font-medium py-2 px-4 rounded-lg shadow-sm">
                         Cancel
                     </button>
                 </div>
            </div>
        </div>
    </div>
    <div id="record-game-modal" class="modal-overlay"> <div class="modal-content">
            <button id="close-record-game-modal-btn" class="modal-close-button">&times;</button>
            <h2 class="text-2xl font-semibold mb-6 text-indigo-700">Record Game Result</h2> <form id="record-game-form">
                <div class="mb-5"> <label for="game-type-select-modal" class="block text-gray-700 text-sm font-bold mb-2">Game Type:</label> <select id="game-type-select-modal" name="game-type" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700" required> <option value="">Select Type</option> <option value="1v1">1 vs 1 (General)</option> <option value="2v2">2 vs 2 (General)</option> <option value="ffa">Free-for-All (FFA - General)</option> <option value="team">Team vs Team (General)</option> <option value="pool">Pool</option> <option value="puttpong">PuttPong</option> <option value="golf">Golf</option> <option value="basketball_pickup">Basketball (Pickup)</option> <option value="basketball_horse">Basketball (HORSE)</option> <option value="volleyball_pickup">Volleyball (Pickup)</option> <option value="board_card">Board / Card Game</option> <option value="cornhole">Cornhole</option> <option value="pickleball">Pickleball</option> </select> </div>
                <div id="sub-type-wrapper-modal" class="mb-5"> <div id="sub-type-pool-modal" class="sub-type-section space-y-2"> <label for="pool-game-mode-modal" class="block text-gray-700 text-sm font-bold mb-1">Pool Game Mode:</label> <select id="pool-game-mode-modal" name="pool_game_mode" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Mode</option> <option value="8ball_1v1">8-Ball (1v1)</option> <option value="9ball_1v1">9-Ball (1v1)</option> <option value="8ball_2v2">8-Ball (2v2)</option> <option value="cutthroat_ffa">Cut-Throat (FFA)</option> </select> </div> <div id="sub-type-board_card-modal" class="sub-type-section space-y-2"> <label for="board-card-scoring-modal" class="block text-gray-700 text-sm font-bold mb-1">Scoring Method:</label> <select id="board-card-scoring-modal" name="board_card_scoring" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Scoring</option> <option value="win_loss_1v1">Win/Loss (1v1)</option> <option value="win_loss_2v2">Win/Loss (2v2)</option> <option value="win_loss_team">Win/Loss (Team vs Team)</option> <option value="points">Points Scored</option> <option value="placement">Placement (FFA)</option> </select> </div> </div>
                <div id="outcome-wrapper-modal"> <div id="outcome-1v1-modal" class="outcome-section space-y-3"> <h3 class="text-xl font-medium text-gray-800">1 vs 1 Outcome</h3> <label for="winner-1v1-modal" class="block text-gray-700 text-xs font-bold mb-1">Winner:</label> <select id="winner-1v1-modal" name="winner_player" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Winner</option> </select> <label for="loser-1v1-modal" class="block text-gray-700 text-xs font-bold mb-1">Loser:</label> <select id="loser-1v1-modal" name="loser_player" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Loser</option> </select> <label for="draw-1v1-modal" class="flex items-center space-x-2 mt-3"> <input type="checkbox" id="draw-1v1-modal" name="is_draw" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 h-4 w-4"> <span class="text-sm text-gray-700">Record as Draw?</span> </label> <div class="mt-3"> <label for="score-1v1-modal" class="block text-gray-700 text-xs font-bold mb-1">Score (Optional):</label> <input type="text" id="score-1v1-modal" name="score" placeholder="e.g., 11-5, 11-9" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 text-sm"> </div> </div> <div id="outcome-2v2-modal" class="outcome-section space-y-3"> <h3 class="text-xl font-medium text-gray-800">2 vs 2 Outcome</h3> <label for="winner-team-2v2-modal" class="block text-gray-700 text-xs font-bold mb-1">Winning Team:</label> <select id="winner-team-2v2-modal" name="winner_team" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Winning Team</option> </select> <label for="loser-team-2v2-modal" class="block text-gray-700 text-xs font-bold mb-1">Losing Team:</label> <select id="loser-team-2v2-modal" name="loser_team" class="shadow border rounded-lg w-full py-3 px-4 text-gray-700"> <option value="">Select Losing Team</option> </select> <label for="draw-2v2-modal" class="flex items-center space-x-2 mt-3"> <input type="checkbox" id="draw-2v2-modal" name="is_draw" class="rounded border-gray-300 text-blue-600 shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50 h-4 w-4"> <span class="text-sm text-gray-700">Record as Draw?</span> </label> <div class="mt-3"> <label for="score-2v2-modal" class="block text-gray-700 text-xs font-bold mb-1">Score (Optional):</label> <input type="text" id="score-2v2-modal" name="score" placeholder="e.g., 21-15, 21-18" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 text-sm"> </div> </div> <div id="outcome-ffa-modal" class="outcome-section space-y-3"> <h3 class="text-xl font-medium text-gray-800">Free-for-All Outcome</h3> <p class="text-sm text-gray-600">Enter players by placement (1st, 2nd, etc.).</p> <div id="ffa-player-entries-modal"> <div class="flex items-center space-x-2 mb-2"> <span class="font-bold w-8 text-right">1st:</span> <select name="ffa_player_1" class="shadow border rounded-lg flex-grow py-3 px-4 text-gray-700"> <option value="">Select Player</option> </select> </div> <div class="flex items-center space-x-2 mb-2"> <span class="font-bold w-8 text-right">2nd:</span> <select name="ffa_player_2" class="shadow border rounded-lg flex-grow py-3 px-4 text-gray-700"> <option value="">Select Player</option> </select> </div> </div> <button type="button" id="add-ffa-place-modal" class="text-sm text-blue-600 hover:underline mt-2">+ Add Another Place</button> </div> <div id="outcome-golf-modal" class="outcome-section space-y-3"> <h3 class="text-xl font-medium text-gray-800">Golf Outcome</h3> <p class="text-sm text-gray-600">Enter score relative to par for each player.</p> <div id="golf-player-entries-modal"> <div class="flex items-center space-x-2 mb-2"> <select name="golf_player_1" class="shadow border rounded-lg flex-grow py-3 px-4 text-gray-700"> <option value="">Select Player</option> </select> <input type="number" name="golf_score_1" placeholder="Score (+/- Par)" class="shadow border rounded-lg w-28 py-2 px-3 text-gray-700"> </div> </div> <button type="button" id="add-golf-player-modal" class="text-sm text-blue-600 hover:underline mt-2">+ Add Another Player</button> </div> <div id="outcome-pickup-modal" class="outcome-section space-y-4"> <h3 class="text-xl font-medium text-gray-800">Pickup Game Outcome</h3> <div class="grid grid-cols-2 gap-4"> <div> <label class="block text-gray-700 text-sm font-bold mb-2">Winning Players:</label> <div id="pickup-winners-list-modal" class="multi-select-list space-y-1"></div> </div> <div> <label class="block text-gray-700 text-sm font-bold mb-2">Losing Players:</label> <div id="pickup-losers-list-modal" class="multi-select-list space-y-1"></div> </div> </div> <div class="mt-3"> <label for="score-pickup-modal" class="block text-gray-700 text-xs font-bold mb-1">Score (Optional):</label> <input type="text" id="score-pickup-modal" name="score" placeholder="e.g., 11-7" class="shadow appearance-none border rounded-lg w-full py-2 px-3 text-gray-700 text-sm"> </div> </div> <div id="outcome-boardgame-points-modal" class="outcome-section space-y-3"> <h3 class="text-xl font-medium text-gray-800">Points-Based Game Outcome</h3> <p class="text-sm text-gray-600">Enter score for each player.</p> <div id="boardgame-points-entries-modal"> <div class="flex items-center space-x-2 mb-2"> <select name="boardgame_player_1" class="shadow border rounded-lg flex-grow py-3 px-4 text-gray-700"> <option value="">Select Player</option> </select> <input type="number" name="boardgame_score_1" placeholder="Score" class="shadow border rounded-lg w-28 py-2 px-3 text-gray-700"> </div> </div> <button type="button" id="add-boardgame-player-modal" class="text-sm text-blue-600 hover:underline mt-2">+ Add Another Player</button> </div> </div>
                 <button type="submit" class="mt-6 bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-5 rounded-lg shadow hover:shadow-md">Record Game</button>
                 <button type="button" id="cancel-record-game-modal-btn" class="ml-3 text-gray-600 hover:text-gray-900 font-medium">Cancel</button>
             </form>
        </div>
    </div>

    <footer class="text-center text-gray-600 text-base mt-12 mb-6"> &copy; 2025 LeaderBored. Keep it friendly!
    </footer>

    <script>
        // --- Basic Page Navigation & Admin Simulation ---
        const ADMIN_PASSWORD = "admin";

        // --- DOM Element References (Assigned in initializeApp) ---
        let sections, navLinks, loginForm, loginError, logoutButton, cancelAdminButtons,
            recordGameModal, openRecordGameModalBtn, closeRecordGameModalBtn, cancelRecordGameModalBtn, recordGameForm,
            gameTypeSelectModal, subTypeWrapperModal, outcomeWrapperModal, poolModeSelectModal, boardCardScoringSelectModal,
            tournamentGameTypeSelect, tournamentParticipantsList, rankingsGameFilter, rankingTablesContainer,
            playersGrid,
            playerInfoModal, closePlayerModalBtn, manageGamesTableBody;

        // --- Placeholder Data ---
        const placeholderPlayers = [
            { id: 'p1', name: 'Alice', overallRank: 1, overallRating: 1350, iconLetter: 'A' },
            { id: 'p2', name: 'Bob', overallRank: 4, overallRating: 1250, iconLetter: 'B' },
            { id: 'p3', name: 'Charlie', overallRank: 2, overallRating: 1310, iconLetter: 'C' },
            { id: 'p4', name: 'Dave', overallRank: 3, overallRating: 1280, iconLetter: 'D' },
            { id: 'p5', name: 'Eve', overallRank: 5, overallRating: 1200, iconLetter: 'E' }
        ];
        const placeholderTeams = [
            { id: 't1', name: 'Alice & Charlie', players: ['p1', 'p3'], rating: 1320 },
            { id: 't2', name: 'Bob & Dave', players: ['p2', 'p4'], rating: 1260 },
            { id: 't3', name: 'Team Alpha', players: [], rating: 1290 },
            { id: 't4', name: 'Team Beta', players: [], rating: 1250 }
        ];
        const placeholderPlayerDetails = {
             p1: { name: 'Alice', overallRank: 1, overallRating: 1350, iconLetter: 'A', stats: '<strong>Cornhole:</strong> Rank #2 (1380 Elo), 15 Wins, 8 Losses<br><strong>Pickleball (2v2):</strong> Rank #1 (Team: Alice & Charlie - 1320 Elo)<br><strong>Golf:</strong> Avg Score: +1.5', activity: '<li>Won vs Charlie in Cornhole (1v1) - <span class="text-gray-500">Now</span></li><li>Lost vs Bob/Dave in Pickleball (2v2 w/ Charlie) - <span class="text-gray-500">1h ago</span></li><li>Played Golf (+2) - <span class="text-gray-500">Yesterday</span></li>' },
             p2: { name: 'Bob', overallRank: 4, overallRating: 1250, iconLetter: 'B', stats: '<strong>Pool (FFA):</strong> Rank #1, 3 Wins (1st Place)<br><strong>Pickleball (2v2):</strong> Rank #3 (Team: Bob & Dave - 1260 Elo)<br><strong>Cornhole:</strong> Rank #5 (1190 Elo)', activity: '<li>Won Pool (FFA) - <span class="text-gray-500">15m ago</span></li><li>Won vs Alice/Charlie in Pickleball (2v2 w/ Dave) - <span class="text-gray-500">1h ago</span></li><li>Played Golf (+5) - <span class="text-gray-500">Yesterday</span></li>' },
             p3: { name: 'Charlie', overallRank: 2, overallRating: 1310, iconLetter: 'C', stats: '<strong>Cornhole:</strong> Rank #1 (1400 Elo)<br><strong>Pickleball (2v2):</strong> Rank #1 (Team: Alice & Charlie - 1320 Elo)<br><strong>Golf:</strong> Avg Score: -1.0', activity: '<li>Lost vs Alice in Cornhole (1v1) - <span class="text-gray-500">Now</span></li><li>Lost vs Bob/Dave in Pickleball (2v2 w/ Alice) - <span class="text-gray-500">1h ago</span></li><li>Played Golf (-1) - <span class="text-gray-500">Yesterday</span></li>' },
             p4: { name: 'Dave', overallRank: 3, overallRating: 1280, iconLetter: 'D', stats: '<strong>Pickleball (2v2):</strong> Rank #3 (Team: Bob & Dave - 1260 Elo)<br><strong>Pool (FFA):</strong> Rank #2', activity: '<li>Placed 2nd in Pool (FFA) - <span class="text-gray-500">15m ago</span></li><li>Won vs Alice/Charlie in Pickleball (2v2 w/ Bob) - <span class="text-gray-500">1h ago</span></li>' },
             p5: { name: 'Eve', overallRank: 5, overallRating: 1200, iconLetter: 'E', stats: '<strong>Pool (FFA):</strong> Rank #3<br><strong>Board Games:</strong> 5 Wins', activity: '<li>Placed 3rd in Pool (FFA) - <span class="text-gray-500">15m ago</span></li>' },
        };
        const placeholderGames = [
            { id: 'g1', date: '2025-04-27 23:00', type: 'Cornhole (1v1)', description: 'Charlie beat Alice' },
            { id: 'g2', date: '2025-04-27 22:45', type: 'Pool (Cut-Throat FFA)', description: '1st: Bob, 2nd: Dave, 3rd: Eve' },
            { id: 'g3', date: '2025-04-27 22:00', type: 'Pickleball (2v2)', description: 'Alice/Bob beat Charlie/Dave' },
            { id: 'g4', date: '2025-04-26 15:00', type: 'Golf', description: 'Alice (+2), Bob (+5), Charlie (-1)' },
        ];

        // Function to assign elements after DOM is loaded
        function assignElements() {
            sections = document.querySelectorAll('.page-section');
            navLinks = document.querySelectorAll('.nav-link');
            loginForm = document.getElementById('login-form');
            loginError = document.getElementById('login-error');
            logoutButton = document.getElementById('logout-button');
            cancelAdminButtons = document.querySelectorAll('.cancel-admin-action');
            recordGameModal = document.getElementById('record-game-modal');
            openRecordGameModalBtn = document.getElementById('open-record-game-modal-btn');
            closeRecordGameModalBtn = document.getElementById('close-record-game-modal-btn');
            cancelRecordGameModalBtn = document.getElementById('cancel-record-game-modal-btn');
            recordGameForm = document.getElementById('record-game-form');
            gameTypeSelectModal = document.getElementById('game-type-select-modal');
            subTypeWrapperModal = document.getElementById('sub-type-wrapper-modal');
            outcomeWrapperModal = document.getElementById('outcome-wrapper-modal');
            poolModeSelectModal = document.getElementById('pool-game-mode-modal');
            boardCardScoringSelectModal = document.getElementById('board-card-scoring-modal');
            tournamentGameTypeSelect = document.getElementById('tournament-game-type-select');
            tournamentParticipantsList = document.getElementById('tournament-participants-list');
            rankingsGameFilter = document.getElementById('rankings-game-filter');
            rankingTablesContainer = document.getElementById('ranking-tables-container');
            playersGrid = document.querySelector('#players-section .grid'); // Use specific selector
            playerInfoModal = document.getElementById('player-info-modal');
            closePlayerModalBtn = document.getElementById('close-player-modal-btn');
            manageGamesTableBody = document.getElementById('manage-games-table-body');
            // Removed managePlayersList and editPlayerForm elements

            // Log if critical elements are missing
            if (!loginForm) console.error("Login form element (#login-form) not found!");
            if (!recordGameModal) console.error("Record game modal element (#record-game-modal) not found!");
            if (!openRecordGameModalBtn) console.error("Open record game modal button (#open-record-game-modal-btn) not found!");
            if (!playersGrid) console.error("Players grid element (#players-grid) not found!");
            if (!playerInfoModal) console.error("Player info modal element (#player-info-modal) not found!");
        }


        // --- Utility Functions ---
        function populateSelect(selectElement, options, valueField = 'id', textField = 'name', prompt = 'Select...') { /* ... */ }
        function populateCheckboxes(containerElement, options, name, valueField = 'id', textField = 'name') { /* ... */ }
        function populateMultiSelectCheckboxes(containerElement, options, name, valueField = 'id', textField = 'name') { /* ... */ }

        // --- Page Section Navigation ---
        function showSection(targetId) {
             if (!sections) { console.error("Sections not assigned yet in showSection"); return; }
             console.log(`[DEBUG] showSection called for: ${targetId}`); // DEBUG
            const cleanTargetId = targetId.startsWith('#') ? targetId.substring(1) : targetId;
            let sectionFound = false;
            // FIRST: Hide ALL sections
            sections.forEach(section => {
                if (section && section.id) { // Basic check
                     section.classList.add('hidden');
                }
            });
            // THEN: Show the target section
            const targetSection = document.getElementById(cleanTargetId);
            if (targetSection) {
                console.log(`[DEBUG] Showing section: ${targetSection.id}`); // DEBUG
                targetSection.classList.remove('hidden');
                sectionFound = true;
                // Populate dynamic content when section is shown
                if (cleanTargetId === 'players-section' && playersGrid) populatePlayersList();
                if (cleanTargetId === 'rankings-section' && rankingTablesContainer) updateRankingsVisibility();
                if (cleanTargetId === 'admin-manage-games-section' && manageGamesTableBody) populateManageGamesTable();
            } else {
                 console.warn(`Section with ID "${cleanTargetId}" not found. Showing home.`);
                 const homeSection = document.getElementById('home-section');
                 if (homeSection) {
                     homeSection.classList.remove('hidden');
                 } else {
                     console.error("Home section (#home-section) not found as fallback.");
                 }
            }

            if (sectionFound) {
                window.scrollTo(0, 0);
            }
        }

        // --- Player List and Modal Functions ---
        function populatePlayersList() {
             if (!playersGrid) { console.warn("Player grid container (#players-grid) not found."); return; }
             console.log("[DEBUG] Populating players list..."); // DEBUG
             playersGrid.innerHTML = ''; // Clear existing list
             if (placeholderPlayers.length === 0) {
                 playersGrid.innerHTML = '<p class="text-gray-500 col-span-full text-center">No players added yet.</p>'; // Span full grid width
                 return;
             }
             placeholderPlayers.forEach(player => {
                 const div = document.createElement('div');
                 div.className = 'player-entry bg-white p-5 rounded-lg shadow hover:shadow-md cursor-pointer flex items-center space-x-4';
                 div.setAttribute('data-player-id', player.id);
                 const iconUrl = `https://placehold.co/48x48/E0E7FF/4F46E5?text=${player.iconLetter}`;
                 div.innerHTML = `
                     <img src="${iconUrl}" alt="Player Icon ${player.name}" class="w-12 h-12 rounded-full flex-shrink-0" onerror="this.onerror=null; this.src='https://placehold.co/48x48/cccccc/ffffff?text=?';">
                     <span class="font-medium text-lg text-gray-800">${player.name}</span> `;
                 // Event listener added via delegation in setupEventListeners
                 playersGrid.appendChild(div);
             });
             console.log(`[DEBUG] Populated players list with ${placeholderPlayers.length} players.`); // DEBUG
        }
        function openPlayerModal(playerId) { /* ... */ }
        function closePlayerModal() { /* ... */ }

        // --- Record Game Modal Functions ---
        function openRecordGameModal() { /* ... */ }
        function closeRecordGameModal() { /* ... */ }

        // --- Admin Management List Population ---
        function populateManageGamesTable() { /* ... (adds listeners via delegation) ... */ }

        // --- Admin Action Handlers ---
        function handleEditGame(gameId) { /* ... */ }
        function handleDeleteGame(gameId, tableRowElement) { /* ... */ }

        // --- Player Modal Edit Mode Handlers ---
        function togglePlayerModalEdit(editMode) { /* ... */ }
        function savePlayerChanges() { /* ... */ }
        function deletePlayer() { /* ... */ }


        // --- Event Listeners Setup ---
        function setupEventListeners() {
             console.log("[DEBUG] Setting up event listeners...");
            // Navigation Links
            if (!navLinks) { console.error("Nav links not found."); return; }
            navLinks.forEach(link => { link.addEventListener('click', handleNavLinkClick); });

            // Admin Login/Logout
            if (loginForm) {
                 console.log("[LOGIN DEBUG] Attaching login form listener in setupEventListeners."); // LOGIN DEBUG
                loginForm.addEventListener('submit', handleLoginFormSubmit); // Use named handler
            } else { console.error("[LOGIN DEBUG] Login form element (#login-form) not found during setupEventListeners."); } // LOGIN DEBUG

            if (logoutButton) logoutButton.addEventListener('click', logout);
            else { console.error("Logout button not found."); }

            if(cancelAdminButtons) {
                cancelAdminButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        const target = button.getAttribute('data-target') || 'admin-section';
                        console.log(`Cancel button clicked, navigating to: ${target}`);
                        showSection(target);
                    });
                });
            }

            // --- Record Game Modal ---
            if (openRecordGameModalBtn) openRecordGameModalBtn.addEventListener('click', openRecordGameModal);
            else { console.error("Open record game modal button not found."); }

            if (closeRecordGameModalBtn) closeRecordGameModalBtn.addEventListener('click', closeRecordGameModal);
            else { console.error("Close record game modal button not found."); }

            if (cancelRecordGameModalBtn) cancelRecordGameModalBtn.addEventListener('click', closeRecordGameModal);
            else { console.error("Cancel record game modal button not found."); }

            if (recordGameModal) recordGameModal.addEventListener('click', (event) => { if (event.target === recordGameModal) closeRecordGameModal(); });
            else { console.error("Record game modal overlay not found."); }

            // Dynamic Form Logic (Record Game MODAL)
            if (gameTypeSelectModal) gameTypeSelectModal.addEventListener('change', updateRecordGameFormModal);
            if (poolModeSelectModal) poolModeSelectModal.addEventListener('change', updateRecordGameFormModal);
            if (boardCardScoringSelectModal) boardCardScoringSelectModal.addEventListener('change', updateRecordGameFormModal);

             // Dynamic Form Logic (Create Tournament)
             if (tournamentGameTypeSelect) tournamentGameTypeSelect.addEventListener('change', updateTournamentParticipants);

            // Add Player/Place/Score Buttons (MODAL versions) - Use Event Delegation
            const outcomeWrapperModalElement = document.getElementById('outcome-wrapper-modal');
            if (outcomeWrapperModalElement) {
                outcomeWrapperModalElement.addEventListener('click', (event) => {
                    if (event.target.matches('#add-ffa-place-modal')) {
                        setupAddPlayerButton('add-ffa-place-modal', 'ffa-player-entries-modal');
                    } else if (event.target.matches('#add-golf-player-modal')) {
                         setupAddPlayerButton('add-golf-player-modal', 'golf-player-entries-modal');
                    } else if (event.target.matches('#add-boardgame-player-modal')) {
                         setupAddPlayerButton('add-boardgame-player-modal', 'boardgame-points-entries-modal');
                    }
                });
            }

            // Rankings Filter
            if (rankingsGameFilter) rankingsGameFilter.addEventListener('change', updateRankingsVisibility);

            // Player Modal Close & Edit Buttons
            if (closePlayerModalBtn) closePlayerModalBtn.addEventListener('click', closePlayerModal);
            if (playerInfoModal) {
                playerInfoModal.addEventListener('click', (event) => {
                    console.log("[DEBUG] Click inside player info modal detected. Target:", event.target); // DEBUG
                    if (event.target === playerInfoModal) {
                        console.log("[DEBUG] Clicked on overlay, closing player modal."); // DEBUG
                        closePlayerModal(); // Close on overlay click
                    } else if (event.target.matches('#edit-player-modal-btn')) {
                        console.log("[DEBUG] Edit player button clicked."); // DEBUG
                        togglePlayerModalEdit(true); // Enter edit mode
                    } else if (event.target.matches('#save-player-changes-btn')) {
                        console.log("[DEBUG] Save player changes button clicked."); // DEBUG
                        savePlayerChanges(); // Save changes
                    } else if (event.target.matches('#cancel-player-edit-btn')) {
                        console.log("[DEBUG] Cancel player edit button clicked."); // DEBUG
                        togglePlayerModalEdit(false); // Cancel edit mode
                    } else if (event.target.matches('#delete-player-btn')) {
                        console.log("[DEBUG] Delete player button clicked."); // DEBUG
                        deletePlayer(); // Delete player
                    }
                });
            }

            // Form Submission Handlers
            handleFormSubmit('add-player-form', 'Player Added!');
            handleFormSubmit('add-team-form', 'Team Added!');
            handleFormSubmit('record-game-form', 'Game Recorded!'); // Handles the modal form
            handleFormSubmit('create-tournament-form', 'Tournament Created!');
            // Removed listener for edit-player-form as it's deleted

            // --- Event Delegation for Dynamic Buttons ---
            // Players Page - Open Modal
            if (playersGrid) {
                playersGrid.addEventListener('click', (event) => {
                    const playerEntry = event.target.closest('.player-entry');
                    if (playerEntry) {
                        const playerId = playerEntry.getAttribute('data-player-id');
                        if (playerId) openPlayerModal(playerId);
                    }
                });
            }

            // Manage Games Page - Edit/Delete
            if (manageGamesTableBody) {
                manageGamesTableBody.addEventListener('click', (event) => {
                    const targetButton = event.target;
                    const gameRow = targetButton.closest('tr');
                    if (!gameRow) return;
                    const gameId = gameRow.getAttribute('data-game-id');
                    if (!gameId) return;

                    if (targetButton.classList.contains('edit-game-btn')) {
                        handleEditGame(gameId);
                    } else if (targetButton.classList.contains('delete-game-btn')) {
                        handleDeleteGame(gameId, gameRow);
                    }
                });
            }

             console.log("Event listeners setup complete.");
        }

        // --- Specific Event Handlers ---
        function handleNavLinkClick(event) {
            const targetId = event.currentTarget.getAttribute('data-target');
            if (targetId) {
                event.preventDefault();
                console.log(`[DEBUG] Navigating to section: ${targetId}`);
                showSection(targetId);
            } else { console.warn("Nav link missing data-target:", event.currentTarget); }
        }

        function handleLoginFormSubmit(event) {
            // This function is now called directly by the event listener in setupEventListeners
            alert("[LOGIN DEBUG] Login form submitted!"); // Alert to confirm event fired
            console.log("[LOGIN DEBUG] handleLoginFormSubmit called."); // Specific log
            const passwordInput = document.getElementById('password');
            if (passwordInput) {
                const passwordValue = passwordInput.value;
                console.log(`[LOGIN DEBUG] Password value from input: "${passwordValue}"`); // Specific log
                login(passwordValue); // Call login function
            } else { console.error("[LOGIN DEBUG] Password input field not found inside handleLoginFormSubmit."); } // Specific log
        }


        // --- Admin Login/Logout Logic ---
        function checkLoginState() {
             const isLoggedIn = sessionStorage.getItem('isAdminLoggedIn') === 'true';
             if (isLoggedIn) {
                 document.body.classList.add('admin-logged-in');
             } else {
                 document.body.classList.remove('admin-logged-in');
                 if(sections) { // Ensure sections exist before looping
                    sections.forEach(section => {
                        if (section.classList.contains('admin-only') && !section.classList.contains('hidden')) {
                           section.classList.add('hidden');
                        }
                    });
                 }
             }
             return isLoggedIn;
        }
        function login(password) {
            alert(`[LOGIN DEBUG] Inside login function. Comparing "${password}" with "${ADMIN_PASSWORD}"`); // Alert to confirm function called
            console.log(`[LOGIN DEBUG] Inside login function. Comparing "${password}" with "${ADMIN_PASSWORD}"`); // Specific log
            const localLoginError = document.getElementById('login-error');
            if (password === ADMIN_PASSWORD) {
                alert("[LOGIN DEBUG] Password MATCHES!"); // Alert on success
                console.log("[LOGIN DEBUG] Password MATCHES. Setting session storage and updating UI."); // Specific log
                sessionStorage.setItem('isAdminLoggedIn', 'true');
                checkLoginState(); // Apply logged-in styles
                // Simplified action on login success for debugging:
                // showSection('admin-section'); // Original line
                document.body.style.backgroundColor = 'lightgreen'; // Temporary visual confirmation
                alert("Login successful! (Body should be green)"); // Temporary alert

                if(localLoginError) localLoginError.classList.add('hidden');
                const passwordInput = document.getElementById('password');
                if(passwordInput) passwordInput.value = '';
                console.log("[LOGIN DEBUG] Admin login successful."); // Specific log
            } else {
                alert("[LOGIN DEBUG] Password DOES NOT MATCH."); // Alert on failure
                console.log("[LOGIN DEBUG] Password DOES NOT MATCH."); // Specific log
                if(localLoginError) localLoginError.classList.remove('hidden');
                 console.log("[LOGIN DEBUG] Admin login failed: Incorrect password."); // Specific log
            }
        }
        function logout() { /* ... */ }

        // --- Dynamic Form Logic (MODAL version) ---
        function updateRecordGameFormModal() { /* ... */ }
        function updateTournamentParticipants() { /* ... */ }

        // --- Add Player/Place/Score Button Logic ---
        function setupAddPlayerButton(buttonId, containerId) { /* ... */ }

        // --- Rankings Filter Logic ---
        function updateRankingsVisibility() { /* ... */ }

        // --- Form Submission Handlers ---
        function handleFormSubmit(formId, successMessage) {
             const form = document.getElementById(formId);
             if (form && formId !== 'login-form') { // Exclude login form from this generic handler now
                 form.addEventListener('submit', (event) => {
                     event.preventDefault();
                     let isValid = true;
                     form.querySelectorAll('select[required], input[required]').forEach(field => {
                         if (!field.value) { isValid = false; field.classList.add('border-red-500'); }
                         else { field.classList.remove('border-red-500'); }
                     });
                     if (!isValid) { alert("Please fill out all required fields."); return; }

                     const formData = Object.fromEntries(new FormData(form));
                     console.log(`Form submitted: ${formId}`, formData);

                     // --- Simulate Data Update ---
                     if (formId === 'add-player-form') {
                         const newPlayerName = formData['player-name'];
                         if (newPlayerName) {
                             const newPlayerId = 'p' + (placeholderPlayers.length + 1); // Simple unique ID
                             const newPlayer = {
                                 id: newPlayerId,
                                 name: newPlayerName,
                                 overallRank: placeholderPlayers.length + 1, // Placeholder rank
                                 overallRating: 1200, // Default rating
                                 iconLetter: newPlayerName.charAt(0).toUpperCase() || '?' // Handle empty name
                             };
                             placeholderPlayers.push(newPlayer);
                             placeholderPlayerDetails[newPlayerId] = { // Add basic details
                                 name: newPlayerName,
                                 overallRank: newPlayer.overallRank,
                                 overallRating: newPlayer.overallRating,
                                 iconLetter: newPlayer.iconLetter,
                                 stats: 'No games played yet.',
                                 activity: '<li>Player created</li>'
                             };
                             console.log("[DEBUG] Added new player:", newPlayer);
                             // Refresh player list if visible
                             if (playersGrid && !playersGrid.closest('.page-section.hidden')) {
                                 populatePlayersList();
                             }
                         }
                     } else if (formId === 'record-game-form') {
                         // Simulate adding game data (won't show anywhere yet)
                         const gameData = {
                             id: 'g' + (placeholderGames.length + 1),
                             date: new Date().toISOString().slice(0, 16).replace('T', ' '),
                             type: formData['game-type'],
                             description: 'Game details from form...' // Needs logic to build description
                         };
                         placeholderGames.push(gameData);
                         console.log("[DEBUG] Recorded new game:", gameData);
                         // Refresh recent games list on dashboard if visible
                         if (document.getElementById('recent-games-list') && !document.getElementById('home-section').classList.contains('hidden')) {
                             // TODO: Add function to refresh recent games list display
                         }
                     }
                     // Add similar logic for 'add-team-form' if needed

                     alert(`${successMessage} (Data logged to console)`);

                     if (formId === 'record-game-form') closeRecordGameModal();
                     // Removed edit-player-form case
                     else if (formId !== 'login-form') showSection('admin-section');

                     form.reset();

                     if (formId === 'record-game-form') updateRecordGameFormModal();
                     else if (formId === 'create-tournament-form' && tournamentParticipantsList) tournamentParticipantsList.innerHTML = '<p class="text-gray-500 text-sm">Select Game Type to see participants.</p>';
                 });
             } else if (formId !== 'login-form') { // Avoid warning for login form
                 console.warn(`Form with ID "${formId}" not found for submission handling.`);
             }
        }

        // --- Initialization ---
        // Function to assign elements after DOM is loaded
        function assignElements() {
            sections = document.querySelectorAll('.page-section');
            navLinks = document.querySelectorAll('.nav-link');
            loginForm = document.getElementById('login-form');
            loginError = document.getElementById('login-error');
            logoutButton = document.getElementById('logout-button');
            cancelAdminButtons = document.querySelectorAll('.cancel-admin-action');
            recordGameModal = document.getElementById('record-game-modal');
            openRecordGameModalBtn = document.getElementById('open-record-game-modal-btn');
            closeRecordGameModalBtn = document.getElementById('close-record-game-modal-btn');
            cancelRecordGameModalBtn = document.getElementById('cancel-record-game-modal-btn');
            recordGameForm = document.getElementById('record-game-form');
            gameTypeSelectModal = document.getElementById('game-type-select-modal');
            subTypeWrapperModal = document.getElementById('sub-type-wrapper-modal');
            outcomeWrapperModal = document.getElementById('outcome-wrapper-modal');
            poolModeSelectModal = document.getElementById('pool-game-mode-modal');
            boardCardScoringSelectModal = document.getElementById('board-card-scoring-modal');
            tournamentGameTypeSelect = document.getElementById('tournament-game-type-select');
            tournamentParticipantsList = document.getElementById('tournament-participants-list');
            rankingsGameFilter = document.getElementById('rankings-game-filter');
            rankingTablesContainer = document.getElementById('ranking-tables-container');
            playersGrid = document.querySelector('#players-section .grid'); // Assign playersGrid
            playerInfoModal = document.getElementById('player-info-modal');
            closePlayerModalBtn = document.getElementById('close-player-modal-btn');
            manageGamesTableBody = document.getElementById('manage-games-table-body');
            // Removed managePlayersList and editPlayerForm elements

            // Log if critical elements are missing
            if (!loginForm) console.error("Login form element (#login-form) not found!");
            if (!recordGameModal) console.error("Record game modal element (#record-game-modal) not found!");
            if (!openRecordGameModalBtn) console.error("Open record game modal button (#open-record-game-modal-btn) not found!");
            if (!playersGrid) console.error("Players grid element (#players-grid) not found!");
            if (!playerInfoModal) console.error("Player info modal element (#player-info-modal) not found!");
        }

        function initializeApp() {
             try {
                console.log("[DEBUG] Initializing App..."); // DEBUG
                assignElements();
                console.log("[DEBUG] Elements assigned."); // DEBUG

                const isLoggedIn = checkLoginState();
                console.log(`[DEBUG] Initial login state: ${isLoggedIn}`); // DEBUG

                if (document.getElementById('team-player1')) populateSelect(document.getElementById('team-player1'), placeholderPlayers);
                if (document.getElementById('team-player2')) populateSelect(document.getElementById('team-player2'), placeholderPlayers);

                // --- Setup Login Listener Directly ---
                if (loginForm) {
                    console.log("[LOGIN DEBUG] Attaching login form listener in initializeApp."); // LOGIN DEBUG
                    loginForm.addEventListener('submit', handleLoginFormSubmit);
                } else {
                    console.error("[LOGIN DEBUG] Login form not found in initializeApp. Cannot attach listener."); // LOGIN DEBUG
                    alert("[LOGIN DEBUG] CRITICAL ERROR: Login form not found. Login will not work."); // Alert user
                }
                // --- End Direct Login Listener Setup ---

                setupEventListeners(); // Setup other event listeners AFTER elements are assigned

                // Determine initial section
                const initialHash = window.location.hash;
                let navigatedByHash = false;
                if (initialHash && initialHash !== '#') {
                    const targetLink = document.querySelector(`.nav-link[href="${initialHash}"]`);
                    if (targetLink) {
                         const targetId = targetLink.getAttribute('data-target');
                         const targetSection = document.getElementById(targetId);
                         const isAdminOnly = targetSection?.classList.contains('admin-only');
                         if (targetId && targetSection && (!isAdminOnly || isLoggedIn)) {
                            console.log(`Navigating to initial section from hash: ${targetId}`);
                            showSection(targetId);
                            navigatedByHash = true;
                         } else if (targetId && targetSection && isAdminOnly && !isLoggedIn) {
                             console.log("Blocked hash nav to admin section.");
                         }
                    }
                }
                if (!navigatedByHash) {
                     const visibleSection = document.querySelector('.page-section:not(.hidden)');
                     if (!visibleSection) {
                         console.log("No initial section visible or from hash, showing home.");
                         showSection('home-section');
                     } else {
                         console.log(`Browser restored visible section: ${visibleSection.id}`);
                        // Ensure content populated if needed
                        if (visibleSection.id === 'players-section') populatePlayersList();
                        if (visibleSection.id === 'rankings-section') updateRankingsVisibility();
                        if (visibleSection.id === 'admin-manage-games-section') populateManageGamesTable();
                        // Removed manage-players population
                     }
                }

                updateRecordGameFormModal();
                console.log("[DEBUG] App Initialized Successfully."); // DEBUG
             } catch (error) {
                 console.error("Error during app initialization:", error);
                 alert("An error occurred while initializing the application. Please check the console.");
             }
        }

        // --- Run Initialization ---
        document.addEventListener('DOMContentLoaded', initializeApp);

    </script>

</body>
</html>

